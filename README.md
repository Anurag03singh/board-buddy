# TaskFlow - Real-Time Task Collaboration Platform

A lightweight Trello/Notion hybrid built with React, TypeScript, and Supabase. Features real-time collaboration, drag-and-drop task management, and activity tracking.

## ğŸš€ Demo Credentials

```
Email: demo@taskflow.com
Password: demo123456
```

**Note**: If demo credentials don't work, you need to create the demo user first. See [SETUP_DEMO_USER.md](SETUP_DEMO_USER.md) for detailed instructions.

**Quick Setup**: 
1. Go to Supabase Dashboard â†’ Authentication â†’ Users
2. Click "Add User"
3. Email: `demo@taskflow.com`, Password: `demo123456`
4. Check "Auto Confirm User"
5. Click "Create User"

## ğŸ“‹ Table of Contents

- [Features](#features)
- [Tech Stack](#tech-stack)
- [Architecture](#architecture)
- [Database Schema](#database-schema)
- [Setup Instructions](#setup-instructions)
- [API Documentation](#api-documentation)
- [Real-Time Strategy](#real-time-strategy)
- [Scalability Considerations](#scalability-considerations)
- [Testing](#testing)

## âœ¨ Features

- **User Authentication**: Secure signup/login with email verification
- **Board Management**: Create and organize multiple project boards with pagination
- **Board Members**: Add team members to boards by email
- **List & Task Management**: Create lists and tasks with full CRUD operations
- **Drag & Drop**: Intuitive task reordering across lists
- **Task Assignments**: Assign team members to tasks with visual avatars
- **Real-Time Sync**: Live updates across all connected users
- **Activity Tracking**: Complete audit log of all board activities
- **Search**: Quick search across boards and tasks
- **Priority & Due Dates**: Task prioritization and deadline management
- **Pagination**: Efficient browsing of large board collections
- **Responsive Design**: Works seamlessly on desktop and mobile

## ğŸ›  Tech Stack

### Frontend
- **React 18** - UI library
- **TypeScript** - Type safety
- **Vite** - Build tool and dev server
- **TanStack Query** - Server state management
- **React Router** - Client-side routing
- **@hello-pangea/dnd** - Drag and drop functionality
- **shadcn/ui** - Component library
- **Tailwind CSS** - Styling
- **Vitest** - Testing framework

### Backend
- **Supabase** - Backend-as-a-Service
  - PostgreSQL database
  - Authentication
  - Real-time subscriptions
  - Row Level Security (RLS)
  - RESTful APIs (auto-generated)

## ğŸ— Architecture

### Frontend Architecture

```
src/
â”œâ”€â”€ components/          # Reusable UI components
â”‚   â”œâ”€â”€ ui/             # shadcn/ui components
â”‚   â”œâ”€â”€ TaskCard.tsx    # Draggable task component
â”‚   â”œâ”€â”€ TaskDialog.tsx  # Task create/edit modal
â”‚   â””â”€â”€ ActivityPanel.tsx # Real-time activity feed
â”œâ”€â”€ contexts/           # React Context providers
â”‚   â””â”€â”€ AuthContext.tsx # Authentication state
â”œâ”€â”€ pages/              # Route components
â”‚   â”œâ”€â”€ Auth.tsx        # Login/signup page
â”‚   â”œâ”€â”€ Boards.tsx      # Board list view
â”‚   â””â”€â”€ BoardView.tsx   # Kanban board view
â”œâ”€â”€ integrations/       # External service integrations
â”‚   â””â”€â”€ supabase/       # Supabase client & types
â”œâ”€â”€ lib/                # Utility functions
â””â”€â”€ hooks/              # Custom React hooks
```

**State Management Strategy:**
- **Server State**: TanStack Query for caching and synchronization
- **Auth State**: React Context for user session
- **Local State**: React useState for component-level state
- **Real-time Updates**: Supabase subscriptions trigger refetches

**Key Design Decisions:**
- Component composition over inheritance
- Optimistic UI updates for better UX
- Separation of concerns (UI, business logic, data fetching)
- Type-safe API calls with TypeScript

### Backend Architecture

**Supabase Architecture:**
- **PostgreSQL Database**: Relational data with ACID guarantees
- **Row Level Security**: Database-level authorization
- **Realtime Engine**: WebSocket-based live updates
- **Edge Functions**: Serverless compute (not used in current implementation)
- **Storage**: File uploads (not used in current implementation)

**API Pattern:**
- RESTful endpoints auto-generated by Supabase
- Client-side SDK handles authentication headers
- RLS policies enforce data access rules
- Optimistic locking via `updated_at` timestamps

## ğŸ—„ Database Schema

### Entity Relationship Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   profiles  â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ id (PK)     â”‚
â”‚ user_id (FK)â”‚â”€â”€â”
â”‚ email       â”‚  â”‚
â”‚ display_nameâ”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   boards    â”‚  â”‚    â”‚board_members â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ id (PK)     â”‚â”€â”€â”¼â”€â”€â”€â†’â”‚ board_id (FK)â”‚
â”‚ title       â”‚  â”‚    â”‚ user_id (FK) â”‚
â”‚ owner_id    â”‚â†â”€â”˜    â”‚ role         â”‚
â”‚ color       â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ description â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1:N
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    lists    â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ id (PK)     â”‚
â”‚ board_id(FK)â”‚
â”‚ title       â”‚
â”‚ position    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1:N
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    tasks    â”‚       â”‚task_assignments  â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ id (PK)     â”‚â”€â”€â”€â”€â”€â”€â†’â”‚ task_id (FK)     â”‚
â”‚ list_id (FK)â”‚       â”‚ user_id (FK)     â”‚
â”‚ board_id(FK)â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ title       â”‚
â”‚ description â”‚
â”‚ priority    â”‚
â”‚ due_date    â”‚
â”‚ position    â”‚
â”‚ created_by  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚activity_log  â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ id (PK)      â”‚
â”‚ board_id (FK)â”‚
â”‚ user_id (FK) â”‚
â”‚ action       â”‚
â”‚ entity_type  â”‚
â”‚ entity_id    â”‚
â”‚ metadata     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Key Tables

**profiles**: User profile information
- Auto-created on signup via trigger
- Stores display name and avatar

**boards**: Project boards
- Owner has full control
- Can have multiple members

**board_members**: Board access control
- Many-to-many relationship
- Role-based permissions (owner/member)

**lists**: Columns within boards
- Ordered by position field
- Cascade delete with board

**tasks**: Individual work items
- Belongs to list and board (denormalized for performance)
- Supports priority, due dates, descriptions
- Ordered by position within list

**task_assignments**: User-task relationships
- Many-to-many (tasks can have multiple assignees)
- Currently in schema but UI not implemented

**activity_log**: Audit trail
- Immutable log of all actions
- JSONB metadata for flexible data

### Indexes

```sql
-- Performance optimization indexes
idx_board_members_user ON board_members(user_id)
idx_board_members_board ON board_members(board_id)
idx_lists_board ON lists(board_id)
idx_tasks_list ON tasks(list_id)
idx_tasks_board ON tasks(board_id)
idx_task_assignments_task ON task_assignments(task_id)
idx_activity_log_board ON activity_log(board_id)
idx_tasks_title ON tasks USING gin(to_tsvector('english', title))
```

## ğŸ”§ Setup Instructions

### Prerequisites

- Node.js 18+ and npm
- Supabase account (free tier works)

### Local Development Setup

1. **Clone the repository**
```bash
git clone <repository-url>
cd taskflow
```

2. **Install dependencies**
```bash
npm install
```

3. **Set up Supabase**

Create a new Supabase project at https://supabase.com

4. **Configure environment variables**

Create `.env.local`:
```env
VITE_SUPABASE_URL=your_supabase_project_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

5. **Run database migrations**
```bash
# Install Supabase CLI
npm install -g supabase

# Link to your project
supabase link --project-ref your-project-ref

# Push migrations
supabase db push
```

6. **Start development server**
```bash
npm run dev
```

Visit `http://localhost:5173`

### Production Deployment

```bash
# Build for production
npm run build

# Preview production build
npm run preview
```

Deploy the `dist` folder to any static hosting service (Vercel, Netlify, Cloudflare Pages, etc.)

## ğŸ“¡ API Documentation

### Authentication

**Sign Up**
```typescript
const { data, error } = await supabase.auth.signUp({
  email: 'user@example.com',
  password: 'password123',
  options: {
    data: { display_name: 'John Doe' }
  }
})
```

**Sign In**
```typescript
const { data, error } = await supabase.auth.signInWithPassword({
  email: 'user@example.com',
  password: 'password123'
})
```

**Sign Out**
```typescript
await supabase.auth.signOut()
```

### Boards

**List Boards**
```typescript
const { data, error } = await supabase
  .from('boards')
  .select('*')
  .order('created_at', { ascending: false })
```

**Create Board**
```typescript
const { data, error } = await supabase
  .from('boards')
  .insert({
    title: 'My Project',
    description: 'Project description',
    owner_id: user.id,
    color: '#14b8a6'
  })
```

### Lists

**Get Lists for Board**
```typescript
const { data, error } = await supabase
  .from('lists')
  .select('*')
  .eq('board_id', boardId)
  .order('position')
```

**Create List**
```typescript
const { data, error } = await supabase
  .from('lists')
  .insert({
    title: 'To Do',
    board_id: boardId,
    position: 0
  })
```

### Tasks

**Get Tasks for Board**
```typescript
const { data, error } = await supabase
  .from('tasks')
  .select('*')
  .eq('board_id', boardId)
  .order('position')
```

**Create Task**
```typescript
const { data, error } = await supabase
  .from('tasks')
  .insert({
    title: 'Task title',
    description: 'Task description',
    list_id: listId,
    board_id: boardId,
    created_by: user.id,
    priority: 'medium',
    position: 0
  })
```

**Update Task**
```typescript
const { data, error } = await supabase
  .from('tasks')
  .update({ 
    title: 'Updated title',
    priority: 'high'
  })
  .eq('id', taskId)
```

**Move Task**
```typescript
const { data, error } = await supabase
  .from('tasks')
  .update({ 
    list_id: newListId,
    position: newPosition
  })
  .eq('id', taskId)
```

### Activity Log

**Get Board Activity**
```typescript
const { data, error } = await supabase
  .from('activity_log')
  .select('*')
  .eq('board_id', boardId)
  .order('created_at', { ascending: false })
  .limit(50)
```

**Log Activity**
```typescript
const { data, error } = await supabase
  .from('activity_log')
  .insert({
    board_id: boardId,
    user_id: user.id,
    action: 'created',
    entity_type: 'task',
    entity_id: taskId,
    entity_title: 'Task title',
    metadata: { additional: 'data' }
  })
```

## ğŸ”„ Real-Time Strategy

### Implementation

TaskFlow uses Supabase Realtime for live collaboration:

**Subscription Setup:**
```typescript
const channel = supabase
  .channel(`board-${boardId}`)
  .on('postgres_changes', {
    event: '*',
    schema: 'public',
    table: 'tasks',
    filter: `board_id=eq.${boardId}`
  }, (payload) => {
    // Refetch data on any change
    fetchData()
  })
  .subscribe()
```

**Tables with Realtime Enabled:**
- `tasks` - Task CRUD operations
- `lists` - List CRUD operations
- `activity_log` - Activity feed updates

**Conflict Resolution:**
- Last-write-wins strategy
- Optimistic UI updates with rollback on error
- Position conflicts resolved by server-side ordering
- `updated_at` timestamps for change tracking

**Performance Optimizations:**
- Filtered subscriptions (only relevant board data)
- Debounced refetches to prevent excessive queries
- Local state updates before server confirmation
- Automatic reconnection on connection loss

### Scalability Considerations

**Current Architecture (0-10K users):**
- Single Supabase instance
- Client-side subscriptions
- Direct database queries
- Suitable for MVP and small teams

**Scaling to 10K-100K users:**
- Implement connection pooling (PgBouncer)
- Add Redis caching layer for frequently accessed data
- Use Supabase Edge Functions for complex operations
- Implement rate limiting per user/board
- Add CDN for static assets

**Scaling beyond 100K users:**
- Horizontal database sharding by board_id
- Separate read replicas for queries
- Message queue (RabbitMQ/Kafka) for activity logs
- Microservices architecture for different domains
- WebSocket server cluster with sticky sessions
- Implement CQRS pattern (separate read/write models)

**Database Optimizations:**
- Partition activity_log by date
- Archive old boards to cold storage
- Implement soft deletes with cleanup jobs
- Add materialized views for analytics
- Use database connection pooling

**Monitoring & Observability:**
- APM tools (DataDog, New Relic)
- Real-time error tracking (Sentry)
- Database query performance monitoring
- WebSocket connection metrics
- User activity analytics

## ğŸ§ª Testing

Run tests:
```bash
npm test              # Run once
npm run test:watch    # Watch mode
```

**Test Coverage:**
- Unit tests for utility functions
- Component tests for UI elements
- Integration tests for data flows
- E2E tests for critical user paths

## ğŸ” Security

- Row Level Security (RLS) enforced at database level
- JWT-based authentication
- HTTPS-only in production
- SQL injection prevention via parameterized queries
- XSS protection via React's built-in escaping
- CSRF protection via SameSite cookies

## ğŸ“ Assumptions & Trade-offs

**Assumptions:**
- Users have stable internet connections
- Boards have < 1000 tasks (performance tested up to this limit)
- Real-time updates are more important than consistency guarantees
- English language only (i18n not implemented)

**Trade-offs:**
- Chose Supabase over custom backend for faster development
- Client-side subscriptions over server-sent events for simplicity
- Denormalized board_id in tasks table for query performance
- Last-write-wins over operational transforms for conflict resolution
- No offline support (requires constant connection)

## ğŸ“„ License

MIT

## ğŸ‘¥ Contributing

Contributions welcome! Please open an issue or PR.
